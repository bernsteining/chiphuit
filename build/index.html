<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="index.css">
    <title>chip8 emulator</title>
</head>

<body>
    <canvas id="canvas" height="32" width="64"></canvas>
    <div id="emulator_state" class="emulator_state"></div>

    <div class="keypad-base" id="keypad">
    </div>

    <label for="file-upload" class="custom-file-upload">
        <i class="fa fa-cloud-upload"></i> Choose chip8 ROM
    </label>

    <input id="file-upload" type="file" />
    <noscript>This page contains webassembly and javascript content, please enable javascript in your
        browser.</noscript>
    <script src='./chiphuit.js'></script>
    <script>
        const { handle_input } = wasm_bindgen;
        wasm_bindgen('./chiphuit_bg.wasm');

        document.onkeypress = keyboard_game;

        keys = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F"];

        // generate keypad
        let keypad = "";
        keys.forEach(key => {
            keypad = keypad + `<div class="key" onclick="handle_input('${key}')" id="${key}">${key}</div>`;

        });
        document.getElementById("keypad").innerHTML = keypad;

        // handle keyboard
        function keyboard_game(event) {
            if (keys.includes(event.key)) {
                handle_input(event.key);
            }
        }

    </script>
</body>

</html>